"use strict";function wpie_set_local_file_uploader(){var e=new plupload.Uploader({runtimes:"html5,silverlight,flash,html4",url:wpiePluginSettings.wpieAjaxURL,drop_element:"wpie_upload_drag_drop",chunk_size:"1024kb",file_data_name:"local_file",multiple_queues:!1,multi_selection:!1,max_file_size:"100Gb",browse_button:"plupload_browse_button",container:"wpie_upload_container",filters:{prevent_duplicates:!1},multipart_params:{action:"wpie_import_local_upload_file",wpie_import_id:wpiePluginSettings.wpieImportId,wpieSecurity:wpiePluginSettings.wpieSecurity},flash_swf_url:"plupload.flash.swf",silverlight_xap_url:"plupload.silverlight.xap"});e.bind("BeforeUpload",function(i,t){e.settings.multipart_params.wpie_import_id=wpiePluginSettings.wpieImportId}),e.bind("Init",function(e){var i=jQuery("#wpie_upload_container");e.features.dragdrop?(i.addClass("wpie_drag_drop"),jQuery("#wpie_upload_container").bind("dragover.wp_uploader",function(){i.addClass("wpie_drag_over")}).bind("dragleave.wp_uploader, drop.wp_uploader",function(){i.removeClass("wpie_drag_over")})):(i.removeClass("drag_drop"),jQuery(".wpie_upload_drag_drop").unbind(".wp_uploader"))}),e.init(),e.bind("FilesAdded",function(e,i){jQuery(".wpie_upload_container_wrapper .wpie_file_list_wrapper").html(""),jQuery(".wpie_upload_drag_drop_data").attr("wpie_status","processing"),jQuery(".wpie_local_uploaded_filename_label").text(wpiePluginSettings.wpieLocalizeText.wpieUploadingText);var t="",p=!0;return jQuery.each(i,function(e,i){var a=i.name.split(".").pop().toLowerCase();return-1===jQuery.inArray(a,["txt","zip","json","xml","xls","xlsx","csv","ods","gz","tar"])?(p=!1,!1):void(t+=i.name+" ( "+plupload.formatSize(i.size)+" ) ")}),p?(jQuery(".wpie_local_uploaded_filename").text(t),void e.start()):(wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.invalidFileExtensionText),!1)}),e.bind("UploadProgress",function(e,i){jQuery(".wpie_uploaded_file_list_wrapper").show(),jQuery(".wpie_import_upload_process_per").css("width",i.percent+"%").html(i.percent+"%")}),e.bind("FileUploaded",function(e,i,t){if(jQuery(".wpie_import_ref_id").val(""),null===t||"undefined"==typeof t.response||null===t.response)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.invalidFileExtensionText),!1;var p=JSON.parse(t.response);return"error"===p.status?(wpieSetErrorMsg(p.message),!1):(wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]=[],void wpieSetFileData(p))}),e.bind("Error",function(e,i){return jQuery(".wpie_uploaded_file_list").hide(),"undefined"!=typeof i.code&&-601===i.code?(wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.invalidFileExtensionText),!1):void wpieHandleAjaxError(i,"")})}function wpieProcessingReimport(e,i,t){var p={processingReimport:wpiePluginSettings.wpieLocalizeText.processingReimport};wpieSetProcessLoader(p);var a={action:"wpie_import_process_reimport",import_id:e,nonce:i,ref_id:t,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:a,dataType:"json",async:!0,success:function(e){if(wpieUpdateProcessLoader("processingReimport"),"error"===e.status)return wpieSetErrorMsg(e.message),!1;"undefined"!=typeof e.import_type&&jQuery(".wpie_import_type_select").val()!==e.import_type&&(jQuery(".wpie_import_type_select").val(e.import_type).trigger("change").trigger("chosen:updated"),"taxonomies"===e.import_type&&"undefined"!=typeof e.taxonomy_type&&jQuery(".wpie_taxonomies_types_select").val()!==e.taxonomy_type&&jQuery(".wpie_taxonomies_types_select").val(e.taxonomy_type).trigger("change").trigger("chosen:updated"));var i="undefined"==typeof e.xpath?"":e.xpath,t="undefined"==typeof e.root?"":e.root;jQuery(".wpie_xpath").val(i);var p="undefined"==typeof e.activeFormat||""===e.activeFormat?"csv":e.activeFormat;jQuery(".wpie_text_format_list_"+p).prop("checked",!0),wpiePluginSettings.reImportData=[],wpiePluginSettings.reImportData.xpath=i,wpiePluginSettings.reImportData.root=t,wpiePluginSettings.reImportData.status="pending",wpiePluginSettings.reImportData.activeFile="undefined"==typeof e.activeFile?"":e.activeFile,wpieSetFileData(e)},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieSetFileData(e){if(0===wpiePluginSettings.wpieImportId&&"undefined"!=typeof e.wpie_import_id&&null!==e.wpie_import_id&&(wpiePluginSettings.wpieImportId=e.wpie_import_id),"undefined"!=typeof e.file_list&&null!==e.file_list){if(0===e.file_count)return jQuery(".wpie_upload_section_wrapper:visible .wpie_file_list_wrapper").html(""),wpieSetErrorMsg(e.message),!1;wpieHandleFileList(e.file_list,".wpie_upload_section_wrapper:visible")}jQuery(".wpie_upload_section_wrapper:visible .wpie_local_uploaded_filename_label").text(wpiePluginSettings.wpieLocalizeText.wpieUploadCompleteText);var i=jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").val(),t=!1;"undefined"!=typeof wpiePluginSettings.reImportData&&"undefined"!=typeof wpiePluginSettings.reImportData.activeFile&&(wpiePluginSettings.reImportData.activeFile!==i&&jQuery(".wpie_upload_section_wrapper:visible").find("."+wpiePluginSettings.reImportData.activeFile).length&&(jQuery(".wpie_upload_section_wrapper:visible").find("."+wpiePluginSettings.reImportData.activeFile).prop("checked",!0),i=jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").val(),t=!0),delete wpiePluginSettings.reImportData.activeFile),wpiePluginSettings.importData.activeFile=i,wpieSetFileAttributes(e);var p={wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetTemplates:wpiePluginSettings.wpieLocalizeText.wpieGetTemplatesText,wpieGetSettingsList:wpiePluginSettings.wpieLocalizeText.wpieGetSettingList,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(p),wpieValidateUploadedFile(t,","),wpieImportGetTemplates(),wpieImportGetSettings()}function wpieSetFileAttributes(e){var i=wpiePluginSettings.importData.activeFile;"undefined"==typeof wpiePluginSettings.importData[i]&&(wpiePluginSettings.importData[i]=[]),wpiePluginSettings.importData[i].fileType="",wpiePluginSettings.importData[i].fileName="","undefined"!=typeof e.file_name&&(wpiePluginSettings.importData[i].fileName=e.file_name,wpiePluginSettings.importData[i].fileType=e.file_name.substr(e.file_name.lastIndexOf(".")+1)),"txt"===wpiePluginSettings.importData[i].fileType?(jQuery(".wpie_text_format_list_wrapper").show(),"undefined"==typeof wpiePluginSettings.importData[i].activeFormat&&(wpiePluginSettings.importData[i].activeFormat="csv"),wpiePluginSettings.importData[i].fileType=wpiePluginSettings.importData[i].activeFormat):jQuery(".wpie_text_format_list_wrapper").hide(),wpiePluginSettings.importData[i].fileSize="0kb","undefined"!=typeof e.file_size&&(wpiePluginSettings.importData[i].fileSize=plupload.formatSize(e.file_size));var t=wpiePluginSettings.importData[i].fileType;if(-1===jQuery.inArray(t,["xls","xlsx","csv","ods"])?jQuery(".wpie_file_options_wrapper").hide():(jQuery(".wpie_file_options_wrapper").show(),"csv"===t?jQuery(".wpie_csv_delimiter_wrapper").show():jQuery(".wpie_csv_delimiter_wrapper").hide()),"undefined"==typeof wpiePluginSettings.importData.changeExcelSheet||wpiePluginSettings.importData.changeExcelSheet===!1){var p="undefined"==typeof e.sheetList?[]:e.sheetList,a="undefined"==typeof e.activeSheet?"":e.activeSheet;wpieHandleExcelSheetList(p,a),"undefined"==typeof wpiePluginSettings.importData[i]&&(wpiePluginSettings.importData[i]=[]),wpiePluginSettings.importData[i].activeSheet=a}else wpiePluginSettings.importData.changeExcelSheet=!1;wpiePluginSettings.importData[i].activeFormat="undefined"==typeof e.activeFormat||""===e.activeFormat?"csv":e.activeFormat}function wpieSetProcessLoader(e){var i="";jQuery.each(e,function(e,t){i+='<div class="wpie_task_wrapper '+e+'" >',i+='<div class="wpie_task_icon_wrapper wpie_task_processing_icon"><i class="fas fa-spinner fa-spin wpie_spinner_btn_icon"></i></div>',i+='<div class="wpie_task_icon_wrapper wpie_task_completed_icon"><i class="fas fa-check-circle wpie_general_btn_icon " aria-hidden="true"></i></div>',i+='<div class="wpie_task_title">'+t+"</div>",i+="</div>"});var t=setInterval(function(){wpiePluginSettings.isModalHide===!0&&(clearInterval(t),jQuery(".wpie_task_list").html(i),"undefined"!=typeof wpiePluginSettings.bsModal&&null!==wpiePluginSettings.bsModal?bootstrap.Modal.getInstance(jQuery(".wpie_processing_data")):wpiePluginSettings.bsModal=new bootstrap.Modal(jQuery(".wpie_processing_data"),{backdrop:"static",keyboard:!1}),wpiePluginSettings.bsModal.show(),jQuery(".wpie_processing_data").on("shown.bs.modal",function(e){wpiePluginSettings.isModalHide=!1}))},200)}function wpieHideProcessingLoader(){var e=setInterval(function(){wpiePluginSettings.isModalHide===!1&&(clearInterval(e),"undefined"==typeof wpiePluginSettings.bsModal||null===wpiePluginSettings.bsModal?jQuery(".wpie_processing_data").modal("hide"):wpiePluginSettings.bsModal.hide(),jQuery(".wpie_processing_data").on("hidden.bs.modal",function(e){wpiePluginSettings.isModalHide=!0}))},200)}function wpieUpdateProcessLoader(e){var i=setInterval(function(){jQuery("."+e).length&&(clearInterval(i),jQuery("."+e).addClass("task_completed"),jQuery(".wpie_task_list").find(".wpie_task_wrapper:not(.task_completed)").length||wpieHideProcessingLoader())},200)}function wpieValidateUploadedFile(e,i){var t=wpiePluginSettings.importData.activeFile;if("undefined"==typeof wpiePluginSettings.importData[t]&&(wpiePluginSettings.importData[t]={}),e||"undefined"==typeof wpiePluginSettings.importData[t].count){var p=e?0:1,a=jQuery(".wpie_file_first_row_is_title:checked").val(),r="";"undefined"!=typeof wpiePluginSettings.importData[t].activeSheet&&(r=wpiePluginSettings.importData[t].activeSheet);var n="";"undefined"!=typeof wpiePluginSettings.importData[t].activeFormat&&(n=wpiePluginSettings.importData[t].activeFormat);var o=[{name:"action",val:"wpie_import_validate_uploads"},{name:"wpie_import_id",val:wpiePluginSettings.wpieImportId},{name:"activeFile",val:t},{name:"activeSheet",val:r},{name:"activeFormat",val:n},{name:"wpie_csv_delimiter",val:i},{name:"is_new_req",val:p},{name:"wpie_file_first_row_is_title",val:a},{name:"wpieSecurity",val:wpiePluginSettings.wpieSecurity}],s=wpieGetValidFormData(o);jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:s,dataType:"json",async:!0,success:function(e){return"error"===e.status?(wpieSetErrorMsg(e.message),!1):(wpieSetFileAttributes(e),jQuery(".wpie_csv_delimiter").val(e.delimiter),wpieUpdateProcessLoader("wpieValidateUpload"),jQuery(".wpie_import_step1_btn").show(),jQuery(document).trigger("wpieValidUploadFile"),wpieGetConfig(),void 0)},error:function(e,i){wpieHandleAjaxError(e,i)}})}else{var l="undefined"!=typeof wpiePluginSettings.importData[t].fileType?wpiePluginSettings.importData[t].fileType:"";-1===jQuery.inArray(l,["xls","xlsx","csv","ods"])?jQuery(".wpie_file_options_wrapper").hide():(jQuery(".wpie_file_options_wrapper").show(),"csv"===l?jQuery(".wpie_csv_delimiter_wrapper").show():jQuery(".wpie_csv_delimiter_wrapper").hide()),wpieUpdateProcessLoader("wpieValidateUpload"),jQuery(".wpie_import_step1_btn").show(),jQuery(document).trigger("wpieValidUploadFile"),wpieGetConfig()}}function wpieGetValidFormData(e){var i="";if("object"==typeof e&&!jQuery.isEmptyObject(e)){var t=jQuery("<form>");jQuery.each(e,function(e,i){"object"!=typeof i||jQuery.isEmptyObject(i)||jQuery("<input>").attr({type:"hidden",name:i.name}).val(i.val).appendTo(t)}),i=t.serialize(),t.remove()}return i}function wpieGetConfig(){if("undefined"==typeof wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]&&(wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]=[]),"undefined"!=typeof wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config)wpieUpdateProcessLoader("wpieGetConfig"),wpieConfigImport();else{var e={action:"wpie_import_get_config",import_id:wpiePluginSettings.wpieImportId,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:e,dataType:"json",async:!0,success:function(e){return"error"===e.status?(wpieSetErrorMsg(e.message),!1):(wpieUpdateProcessLoader("wpieGetConfig"),"undefined"!=typeof e.config?wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config=e.config:wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config={},wpieConfigImport(),void 0)},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieConfigImport(){var e=wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config;wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig=!0,"undefined"!=typeof e.import_type&&""!==e.import_type&&(jQuery(".wpie_import_type_select").val()!==e.import_type&&(jQuery(".wpie_import_type_select").val(e.import_type).trigger("chosen:updated"),wpieImportGetTemplates(),wpieImportGetSettings()),"taxonomies"!==e.import_type?jQuery(".wpie_taxonomies_types_wrapper").hide():jQuery(".wpie_taxonomies_types_wrapper").show(),"taxonomies"===e.import_type&&"undefined"!=typeof e.import_sub_type&&""!==e.import_type&&jQuery(".wpie_taxonomies_types_select").val()!==e.import_sub_type&&jQuery(".wpie_taxonomies_types_select").val(e.import_sub_type).trigger("change").trigger("chosen:updated")),wpieGetImportFields(jQuery(".wpie_import_type_select").val()),wpieGetFilteredRecords(0,1,"","",!0)}function wpieSetTemplate(e){if("object"==typeof e&&!jQuery.isEmptyObject(e)){wpieSetCF(e),wpieSetTaxonomy(e),jQuery(document).trigger("wpieChangeTemplate",[e]),jQuery(".wpie_item_update_field").prop("checked",!1),jQuery.each(e,function(e,i){if(e.match("^wpie_item_cf")||e.match("^wpie_item_acf")||e.match("^wpie_item_taxonomy")||e.match("^wpie_item_set_taxonomy")||!(e.match("^wpie_item_")||e.match("^wpie_existing_item")||e.match("^is_update_item")||e.match("^wpie_wpml_lang")||e.match("^wpie_polylang_lang")))return!0;if(jQuery("."+e).length)if(jQuery("."+e).first().is(".wpie_radio,.wpie_checkbox")){var t=!0;jQuery.each(jQuery("."+e),function(e){"as_specified"!==i&&jQuery(this).val()===i?(jQuery(this).prop("checked",!0),t=!1):jQuery(this).prop("checked",!1)}),t===!0?(jQuery("."+e+"_as_specified").prop("checked",!0).trigger("change"),jQuery("."+e+"_as_specified_data").val(i)):(jQuery("."+e+"_as_specified").prop("checked",!1).trigger("change"),jQuery("."+e+"_as_specified_data").val(""))}else if(jQuery("."+e).first().is(".wpie_content_data_select")){var t=!0;jQuery.each(jQuery("."+e+" option"),function(e){return jQuery(this).attr("value")===i?(t=!1,!1):void 0}),t?(jQuery("."+e).val("as_specified").trigger("chosen:updated").trigger("change"),jQuery("."+e+"_as_specified_wrapper").show(),jQuery("."+e+"_as_specified_data").val(i)):(jQuery("."+e).val(i).trigger("chosen:updated").trigger("change"),jQuery("."+e+"_as_specified_wrapper").hide(),jQuery("."+e+"_as_specified_data").val(""))}else jQuery("."+e).val(i)});var i=["wpie_item_unsuccess_set_draft","wpie_item_set_image_title","wpie_item_set_image_caption","wpie_item_set_image_alt","wpie_item_set_image_description","wpie_item_image_rename","wpie_item_change_ext","wpie_item_attachement_search_for_existing"];jQuery.each(i,function(i,t){"undefined"==typeof e[t]&&jQuery("."+t).prop("checked",!1)}),i=["wpie_item_search_existing_images","wpie_item_keep_images","wpie_item_first_imaege_is_featured","wpie_item_import_img_tags"],jQuery.each(i,function(i,t){"undefined"==typeof e[t]&&jQuery("."+t).prop("checked",!0)}),jQuery(document).trigger("wpieAfterChangeTemplate",[e]),wpieSetToolTip()}wpieUpdateProcessLoader("wpieChangeTemplates")}function wpieSetToolTip(){"function"==typeof jQuery.fn.tipso&&jQuery(".wpie_data_tipso").length&&jQuery(".wpie_data_tipso").tipso({useTitle:!1,background:"rgba(0,0,0,0.8)",color:"#ffffff",size:"small",tooltipHover:!0})}function wpieValidateProcess(){return!0}function wpieGetImportFields(e){var i=jQuery(".wpie_taxonomies_types_select").val(),t={};if("taxonomies"===e?"undefined"!=typeof wpiePluginSettings.importData[e]&&"undefined"!=typeof wpiePluginSettings.importData[e][i]&&"undefined"!=typeof wpiePluginSettings.importData[e][i].fields&&(t=wpiePluginSettings.importData[e][i]):"undefined"!=typeof wpiePluginSettings.importData[e]&&"undefined"!=typeof wpiePluginSettings.importData[e].fields&&(t=wpiePluginSettings.importData[e]),wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig=!0,jQuery.isEmptyObject(t)){var i=jQuery(".wpie_taxonomies_types_select").val(),p={action:"wpie_import_get_fields",type:e,taxonomy:i,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:p,dataType:"json",async:!0,success:function(t){if("error"===t.status)return wpieSetErrorMsg(t.message),!1;wpieUpdateProcessLoader("wpieGetFields");var p={};"undefined"!=typeof t.fields&&(p.fields=t.fields,jQuery(".wpie_field_mapping_section").html(t.fields),jQuery(".wpie_field_mapping_section").find(".wpie_content_data_select").chosen()),"undefined"!=typeof t.search_fields&&(p.searchFields=t.search_fields,jQuery(".wpie_search_item_wrapper").html(t.search_fields)),"undefined"!=typeof t.update_fields&&(p.updateFields=t.update_fields,jQuery(".wpie_update_item_wrapper").html(t.update_fields)),"undefined"==typeof wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]=[]),"taxonomies"===e?wpiePluginSettings.importData[e][i]=p:wpiePluginSettings.importData[e]=p,wpieChangeConfig()},error:function(e,i){wpieHandleAjaxError(e,i)}})}else jQuery(".wpie_field_mapping_section").html(t.fields),jQuery(".wpie_field_mapping_section").find(".wpie_content_data_select").chosen(),"undefined"!=typeof t.searchFields&&jQuery(".wpie_search_item_wrapper").html(t.searchFields),"undefined"!=typeof t.updateFields&&jQuery(".wpie_update_item_wrapper").html(t.updateFields),wpieUpdateProcessLoader("wpieGetFields"),wpieChangeConfig()}function wpieChangeConfig(){if(jQuery(document).trigger("wpieBeforeChangeConfig"),"undefined"!=typeof wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]&&"undefined"!=typeof wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig&&wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig===!0){wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig=!1;var e=wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config;jQuery(document).trigger("wpieChangeConfig",[e.fields]),"undefined"!=typeof e.fields&&wpieSetTemplate(e.fields)}wpieSetToolTip(),jQuery(document).trigger("wpieAfterChangeConfig")}function wpieGetFilteredRecords(e,i,t,p,a){var r={action:"wpie_import_get_filtered_records",wpie_import_id:wpiePluginSettings.wpieImportId,start:e,length:i,xpath:t,root:p,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:r,dataType:"json",success:function(i){if("error"===i.status)return wpieSetErrorMsg(i.message),!1;jQuery(".wpie_element_nav_element").val(e+1);var r=wpiePluginSettings.importData.activeFile;if("undefined"!=typeof i.count&&(wpiePluginSettings.importData[r].count=i.count,jQuery(".wpie_data_element_action_nav_total").html(i.count)),(""===t||a)&&"undefined"!=typeof i.xpath){var n=i.xpath.substring(1);wpiePluginSettings.importData[r].xpath=n,jQuery(".wpie_xpath").val(n)}""!==p&&!a||"undefined"==typeof i.root||(wpiePluginSettings.importData[r].root=i.root),"undefined"!=typeof i.filter_element&&(wpiePluginSettings.importData[r].node_list=i.filter_element,jQuery(".wpie_element_list").html("").append(jQuery("<option></option>").val("").text(wpiePluginSettings.wpieLocalizeText.selectElementText)),jQuery.each(i.filter_element,function(e,i){jQuery(".wpie_element_list").append(jQuery("<option></option>").val(i).text(i))}),jQuery(".wpie_element_list").val("").trigger("chosen:updated"));var o="",s=!0;if("undefined"==typeof i.file_type||"csv"!==i.file_type&&"xls"!==i.file_type&&"xlsx"!==i.file_type){if(jQuery(".wpie_element_tag_outer").show(),"undefined"!=typeof i.node_list&&!jQuery.isEmptyObject(i.node_list)){var l="";jQuery.each(i.node_list,function(e,i){if(wpiePluginSettings.importData[r].root===e)var t="wpie_active";else var t="";l+='<div class="wpie_layout_tag_wrapper '+t+'"><div class="wpie_layout_tag_name">'+e+'</div><div class="wpie_layout_tag_count">'+i+"</div></div>"}),jQuery(".wpie_element_tag_wrapper").html(l),wpiePluginSettings.importData[r].node_list=i.node_list}"undefined"!=typeof i.content&&jQuery.each(i.content,function(e,i){o+=wpieGenerateXmlTagView(i)})}else s=!1,jQuery(".wpie_element_tag_outer").hide(),"undefined"!=typeof i.content&&jQuery.each(i.content,function(e,i){o+=wpieGenerateTableView(i)});return jQuery(".wpie_data_preview").html(o),jQuery(".wpie_data_fields_container").html(o),s?jQuery(".wpie_field_mapping_data_wrapper .wpie_data_fields_container").find(".wpie_tag.wpie_opening:not(.wpie_tag_has_child) .wpie_tag_name,.wpie_tag_attr_name").wpieInsertAtCaret():jQuery(".wpie_data_fields_container").find(".wpie_tag_table_header_data").wpieInsertAtCaret(),wpiePluginSettings.importData[r].content=i.content,wpieUpdateProcessLoader("wpieGetRecords"),wpieSetReimportData(),0===wpiePluginSettings.importData[r].count?(jQuery(".wpie_import_step1").is(":visible")&&jQuery(".wpie_import_step1_btn").hide(),wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieNoRecordsFoundText),!1):void 0},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieSetReimportData(){if("undefined"==typeof wpiePluginSettings.reImportData||"undefined"==typeof wpiePluginSettings.reImportData.status)return!1;if("pending"!==wpiePluginSettings.reImportData.status)return!1;wpiePluginSettings.reImportData.status="completed";var e=jQuery(".wpie_xpath").val();e!==wpiePluginSettings.reImportData.xpath&&wpieUpdateXpath(wpiePluginSettings.reImportData.xpath,wpiePluginSettings.reImportData.root)}function wpieHandleAjaxError(e,i){var t="";return t=0===e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_not_connect_error:400===e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_400_error:404===e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_404_error:500===e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_internal_server_error:"parsererror"===i?wpiePluginSettings.wpieLocalizeText.wpie_ajax_jason_parse_error:"timeout"===i?wpiePluginSettings.wpieLocalizeText.wpie_ajax_time_out_error:"abort"===i?wpiePluginSettings.wpieLocalizeText.wpie_ajax_request_aborted_error:wpiePluginSettings.wpieLocalizeText.wpie_ajax_uncaught_error+e.responseText,wpieSetErrorMsg(t),!1}function wpieSetStrictErrorMsg(e){wpieHideLoader(),jQuery(".wpie_strict_error_content").html(e);var i=new bootstrap.Modal(jQuery(".wpie_strict_error_model"),{backdrop:"static",keyboard:!1});i.show()}function wpieSetErrorMsg(e){wpieHideLoader(),wpieHideProcessingLoader(),jQuery(".wpie_error_content").html(e);var i=new bootstrap.Modal(jQuery(".wpie_error_model"),{backdrop:!0});i.show()}function wpieSetSuccessMsg(e){jQuery.notify({message:'<i class="far fa-check-circle"></i> '+e},{type:"success",placement:{align:"right",from:"bottom"},animate:{enter:"animate__animated animate__fadeInUp",exit:"animate__animated animate__fadeOutDown"}})}function wpieHandleExcelSheetList(e,i){var t=1;Array.isArray(e)&&(t=e.length);var p=jQuery(".wpie_upload_section_wrapper:visible .wpie_excel_sheets_wrapper");if(p.html(""),t>1){var a=(jQuery("<div>").addClass("wpie_sheet_list_header").text(wpiePluginSettings.wpieLocalizeText.wpieChooseSheetText).appendTo(p),jQuery("<div>").addClass("wpie_sheet_list_container").appendTo(p)),r=!1,n="";jQuery.each(e,function(e,t){r=t===i?!0:!1,n=jQuery("<div>").addClass("wpie_sheet_list_element").appendTo(a),jQuery("<input>").addClass("wpie_sheet_list wpie_upload_sheet_list wpie_radio").attr({type:"radio",id:"wpie_sheet_"+t,name:"wpie_import_excel_sheet"}).prop("checked",r).val(t).appendTo(n),jQuery("<label>").addClass("wpie_sheet_list_data wpie_radio_label").attr("for","wpie_sheet_"+t).text(t).appendTo(n)}),p.show()}else p.hide()}function wpieHandleFileList(e,i){var t='<div class="wpie_file_list_header">'+wpiePluginSettings.wpieLocalizeText.wpieChooseFileText+'</div><div class="wpie_file_list_container">',p=!0,a=(jQuery(".wpie_upload_type").val(),"");jQuery.each(e,function(e,i){if(p===!0){p=!1;var r='checked="checked"';a=e}else var r="";t+='<div class="wpie_file_list_element" ><input class="wpie_file_list wpie_upload_file_list wpie_radio '+i.fileKey+'"  type="radio" id="'+i.fileKey+'" value="'+i.fileKey+'" name="wpie_import_local_upload" '+r+'><label class="wpie_file_list_data wpie_radio_label"  for="'+i.fileKey+'">'+i.fileName+"</label></div>"}),t+="</div>",jQuery(i).find(".wpie_file_list_wrapper").html(t).show(),jQuery(i).find(".wpie_upload_finalFile").val(a)}function wpieShowLoader(){jQuery(".wpie_loader").removeClass("wpie_hidden")}function wpieHideLoader(){jQuery(".wpie_loader").addClass("wpie_hidden")}function wpieRefreshImport(){if(!wpieValidateImportExt())return!1;var e=jQuery(".wpie_import_type_select").val();jQuery(".wpie_content_data").attr("class","wpie_content_data wpie_"+e);var i={wpieGetTemplates:wpiePluginSettings.wpieLocalizeText.wpieGetTemplatesText,wpieGetSettingsList:wpiePluginSettings.wpieLocalizeText.wpieGetSettingList,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText};wpieSetProcessLoader(i),setTimeout(function(){wpieImportGetTemplates(),wpieImportGetSettings(),"taxonomies"===e?jQuery(".wpie_taxonomies_types_wrapper").slideDown():jQuery(".wpie_taxonomies_types_wrapper").slideUp(),wpieGetImportFields(e)},1500)}function wpieValidateImportExt(){var e=jQuery(".wpie_import_type_select").val(),i=!0,t="";if(!Array.isArray(wpiePluginSettings.wpieExtensions)){var p=[];jQuery.isEmptyObject(wpiePluginSettings.wpieExtensions)||jQuery.each(wpiePluginSettings.wpieExtensions,function(e){p.push(e)}),wpiePluginSettings.wpieExtensions=p}return"undefined"!=typeof wpiePluginSettings.isWcActive&&1!==wpiePluginSettings.isWcActive&&-1!==jQuery.inArray(e,["shop_customer","shop_order","shop_coupon","product","product_attributes"])?i=!0:"users"===e?wpiePluginSettings.wpieExtensions.indexOf("wpie_user_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportUserExtDisableText,i=!1):"shop_customer"===e?wpiePluginSettings.wpieExtensions.indexOf("wpie_wc_import")<0?(t=wpiePluginSettings.wpieLocalizeText.wpieImportWCExtDisableText,i=!1):wpiePluginSettings.wpieExtensions.indexOf("wpie_user_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportUserExtDisableText,i=!1):"shop_order"===e||"shop_coupon"===e||"product"===e?wpiePluginSettings.wpieExtensions.indexOf("wpie_wc_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportWCExtDisableText,i=!1):"product_attributes"===e&&wpiePluginSettings.wpieExtensions.indexOf("wpie_product_attribute_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportPAExtDisableText,i=!1),i===!1?(jQuery(".wpie_import_type_select").val("post").trigger("chosen:updated"),"taxonomies"===e?jQuery(".wpie_taxonomies_types_wrapper").slideDown():jQuery(".wpie_taxonomies_types_wrapper").slideUp(),wpieGetImportFields("post"),wpieSetErrorMsg(t),!1):!0}function wpieGotoRecord(e){var i=wpiePluginSettings.importData.activeFile,t=wpiePluginSettings.importData[i].root,p=wpiePluginSettings.importData[i].xpath,a=wpiePluginSettings.importData[i].count;e>=1&&a>=e?wpieGetFilteredRecords(e-1,1,p,t,!1):wpieUpdateProcessLoader("wpieGetRecords")}function wpieGenerateTableView(e){var i=jQuery("<table>");i.attr({width:"100%",cellspacing:0}).addClass("wpie_import_data_preview table table-striped table-bordered");var t=jQuery("<thead>");"object"==typeof e&&null!==e&&"object"==typeof e.value&&null!==e.value&&jQuery.each(e.value,function(e,i){var p="undefined"!=typeof i.path?i.path:"",a="undefined"!=typeof i.name?i.name:"",r="undefined"!=typeof i.value?i.value:"",n=jQuery("<tr>"),o=jQuery("<th>"),s=jQuery("<div>").attr("data_value",p).addClass("wpie_tag_table_header_data").text(a);o.addClass("wpie_tag_header_wrapper").append(s);var l="",_="";""!==r&&r.length>200&&(l=jQuery("<span>"),l.addClass("wpie_xml_data_more wpie_show_more_data").text(wpiePluginSettings.wpieLocalizeText.showMoreText),_=jQuery("<div>").addClass("wpie_tag_content_full_text").text(r),r=r.substring(0,200));var w=jQuery("<td>"),u=jQuery("<div>").addClass("wpie_tag_table_contant_data wpie_tag_content_text").text(r);w.addClass("wpie_tag_contant_data_wrapper").append(u).append(_).append(l),n.append(o).append(w),t.append(n)}),i.append(t);var p=jQuery("<tbody>");i.append(p);var a=jQuery("<div>").append(i).html();return a}function wpieGenerateXmlTagView(e){var i="";if("object"==typeof e&&null!==e){var t="",p="",a="",r="";"object"==typeof e.value&&null!==e.value?(jQuery.each(e.value,function(e,i){t+=wpieGenerateXmlTagView(i)}),a=" wpie_tag_section_container",r=" wpie_tag_has_child"):"undefined"!=typeof e.value&&(p+=e.value);var n=e.name,o=e.path,s="";"object"!=typeof e["@attributes"]||null===e["@attributes"]||jQuery.isEmptyObject(e["@attributes"])||jQuery.each(e["@attributes"],function(e,i){s+='<span class="wpie_tag_attr" >',s+='<span class="wpie_tag_attr_name" data_value="'+o+"/@"+e+'"> '+e+'</span> = <span class="wpie_tag_attr_value">"'+i+'" </span>',s+="</span>"});var l="",_="",w="";(""!==t&&t.length>40||""!==p&&p.length>40)&&(l='<i aria-hidden="true" class="fas fa-plus wpie_layout_tag_icon wpie_layout_expand_icon"></i><i aria-hidden="true" class="fas fa-minus wpie_layout_collapsed_icon wpie_layout_tag_icon"></i>',""!==p&&p.length>200&&(_=jQuery("<span>"),_.addClass("wpie_xml_data_more wpie_show_more_data").text(wpiePluginSettings.wpieLocalizeText.showMoreText),w=jQuery("<div>").addClass("wpie_tag_content_full_text").text(p),p=p.substring(0,200)));var u=jQuery("<div>");u.addClass("wpie_tag_outer_wrapper");var d=jQuery("<span>");d.addClass("wpie_tag_name").attr("data_value",o).text(n);var c=jQuery("<div>");c.addClass("wpie_tag wpie_opening "+r).append(l).append("&lt;").append(d).append(s).append("&gt;");var i=jQuery("<div>");if(i.addClass("wpie_tag_content "+a),""===p)i.html(t);else{var g=jQuery("<div>").addClass("wpie_tag_content_text").text(p);i.append(g).append(w).append(_)}var m=jQuery("<span>");m.addClass("wpie_tag_name").text(n);var f=jQuery("<div>");f.addClass("wpie_tag wpie_closing").append("&lt;/").append(m).append(s).append("&gt;"),u.append(c).append(i).append(f),i=jQuery("<div>").append(u).html()}return i}function wpieAddNewImportRule(){var e=jQuery(".wpie_element_list").val(),i=jQuery(".wpie_element_list").find("option:selected").text(),t=jQuery(".wpie_element_rule").val(),p=jQuery(".wpie_element_rule").find("option:selected").text(),a=jQuery(".wpie_element_value").val();if(""===e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.selectElementText),!1;if(""===t)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.selectExportRuleText),!1;var r=jQuery(".wpie_filter_data_rule").length;if(r>0){var n=Math.floor(1e8*Math.random()+1),o='<div class="wpie_rule_condition_wrapper"><input type="radio" class="wpie_radio wpie_rule_clause" checked="checked" name="wpie_content_data_rule_condition_'+n+'" id="wpie_content_data_rule_condition_and_'+n+'" value="and"/><label for="wpie_content_data_rule_condition_and_'+n+'" class="wpie_radio_label">'+wpiePluginSettings.wpieLocalizeText.andText+'</label></div><div class="wpie_rule_condition_wrapper wpie_rule_condition_or_wrapper"><input type="radio" class="wpie_radio wpie_rule_clause" name="wpie_content_data_rule_condition_'+n+'" id="wpie_content_data_rule_condition_or_'+n+'" value="or"/><label for="wpie_content_data_rule_condition_or_'+n+'" class="wpie_radio_label">'+wpiePluginSettings.wpieLocalizeText.orText+"</label></div>";jQuery(".wpie_filter_rule_table .wpie_filter_data_rule").last().find(".wpie_filter_data_rule_cond_data").html(o)}else jQuery(".wpie_apply_rule_wrapper").show();var s='<tr class="wpie_filter_data_rule" ><td class="wpie_filter_rule_list wpie_filter_data_rule_node" wpie_data="'+e+'">'+i+'</td><td class="wpie_filter_rule_list wpie_filter_data_rule_cond" wpie_data="'+t+'">'+p+'</td><td class="wpie_filter_rule_list wpie_filter_data_rule_val">"'+a+'"</td><td class="wpie_filter_rule_list wpie_filter_data_rule_cond_data"></td><td class="wpie_filter_rule_list wpie_filter_data_rule_action"><i class="fas fa-trash wpie_trash_general_btn_icon wpie_rule_trash_btn " aria-hidden="true"></i></td></tr>';
return jQuery(".wpie_filter_rule_table").append(s),!0}function wpieXpathBuilder(e,i){var t="",p=wpiePluginSettings.importData.activeFile,a=wpiePluginSettings.importData[p].root;return i&&e.length>1&&(t+=" ("),e.each(function(){var p=jQuery(this).find(".wpie_filter_data_rule_node").attr("wpie_data"),r=jQuery(this).find(".wpie_filter_data_rule_cond").attr("wpie_data"),n=jQuery(this).find(".wpie_filter_data_rule_val").html();if(n=n.slice(1,-1),jQuery(this).find(".wpie_rule_clause:checked").length>0)var o=jQuery(this).find(".wpie_rule_clause:checked").val();else var o=!1;var s=!1,l="",_="";switch(-1!==p.indexOf("@")&&(s=!0,l=p.split("@")[0],_=p.split("@")[1]),t+=s?l===a?"":l.replace(/->/g,"/"):p.replace(/->/g,"/"),s&&(t+="@"+_),r){case"equals":t+=' = "%s"';break;case"not_equals":t+=' != "%s"';break;case"greater":t+=' > "%s"';break;case"equals_or_greater":t+=' >= "%s"';break;case"less":t+=' < "%s"';break;case"equals_or_less":t+=' <= "%s"';break;case"contains":t+='[contains(.,"%s")]';break;case"not_contains":t+='[not(contains(.,"%s"))]';break;case"is_empty":t+="[not(string())]";break;case"is_not_empty":t+="[string()]"}t=t.replace("%s",n),o&&(t+=" "+o+" "),i&&e.length>1&&(t+=") ")}),t}function wpieAddSerialyzeLayout(e,i){if(e.closest(".wpie_cf_table").find(".wpie_cf_child_data").hide(),jQuery(".wpie-cf-activated").removeClass("wpie-cf-activated"),e.closest("tr").addClass("wpie-cf-activated"),e.closest("tr").find(".wpie_cf_child_data .wpie_cf_table").length>=1)i===!0&&e.closest("tr .wpie_item_cf_value_wrapper").children(".wpie_cf_child_data").show();else{var t=wpieRand(20);e.closest(".wpie_cf_table").find("select").chosen("destroy");var p=jQuery("<div>").append(e.closest(".wpie_cf_table").clone()).html(),a=e.closest("tr .wpie_item_cf_value_wrapper").children(".wpie_cf_child_data");a.html(p),i===!0&&a.show(),a.find("tbody tr:not(.wpie-cf-activated)").remove(),a.find("tbody tr").first().attr("wpie_row_id",t);var r=a.find(".wpie_item_cf_value").first().attr("name");r=wpieReplaceAll(r,"[value]","[values]"),a.find(".wpie_item_cf_name").first().attr("name",r+"["+t+"][name]").val(""),a.find(".wpie_item_cf_value").first().attr("name",r+"["+t+"][value]").val(""),a.find(".wpie_item_cf_option").first().attr("name",r+"["+t+"][option]").val("normal").trigger("change"),e.closest(".wpie_cf_table").find("select").chosen()}}function wpieRand(e){for(var i="",t="abcdefghijklmnopqrstuvwxyz0123456789",p=t.length,a=0;e>a;a++)i+=t.charAt(Math.floor(Math.random()*p));return i}function wpieAddNewCF(e){var i=e.children("tbody").children(".wpie_data_row").last(),t=i.attr("wpie_row_id"),p=wpieRand(20);i.find(".wpie_content_data_select").chosen("destroy");var a=jQuery("<div>").append(i.clone()).html();a=wpieReplaceAll(a,t,p),i.find(".wpie_content_data_select").chosen(),e.children("tbody").first().append(a);var r=e.children("tbody").children(".wpie_data_row").last();r.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_child_data").html("").hide(),r.children(".wpie_item_cf_option_wrapper").find(".wpie_content_data_select").val("normal").trigger("change").chosen(),r.children(".wpie_item_cf_name_wrapper").find(".wpie_item_cf_name").val(""),r.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_normal_data").find(".wpie_item_cf_value").val("")}function wpieEscapeRegExp(e){return"undefined"!=typeof e&&null!==typeof e?e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):void 0}function wpieReplaceAll(e,i,t){return"undefined"!=typeof e&&null!==typeof e?e.replace(new RegExp(wpieEscapeRegExp(i),"g"),t):e}function wpieAddNewSerializeCF(e){var i=e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_key").attr("name"),t=e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_value").attr("name"),p=parseInt(i.substring(i.lastIndexOf("[")+1,i.lastIndexOf("]"))),a="]["+(p+1)+"]",r="]["+p+"]";i=i.replace(r,a),t=t.replace(r,a);var n=e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").first().clone();e.find(".wpie_cf_serialized_option_container").append(n),e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_key").val("").attr("name",i),e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_value").val("").attr("name",t)}function wpieUpdateXpath(e,i){var t={wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(t),jQuery(".wpie_xpath").val(e);var p=wpiePluginSettings.importData.activeFile;wpiePluginSettings.importData[p].xpath=e,wpiePluginSettings.importData[p].root=i,wpieGetFilteredRecords(0,1,e,i,!0)}function wpieValidateUpdateFields(){if(jQuery(".wpie_item_update_specific").is(":checked")){if(jQuery(".wpie_item_update_field:checked").length<1)return jQuery(".wpie_update_item_data_container").addClass("wpie_required"),!1}else if(jQuery(".wpie_item_update_product_price_stock").is(":checked")){var e=!1;if(jQuery(".is_update_item_product_price_data").is(":checked")&&(jQuery(".is_update_item_product_price_regular_price").is(":checked")||jQuery(".is_update_item_product_price_sale_price").is(":checked"))&&(e=!0),jQuery(".is_update_item_product_stock_data").is(":checked")&&(jQuery(".is_update_item_product_stock_stock").is(":checked")||jQuery(".is_update_item_product_stock_manage_stock").is(":checked")||jQuery(".is_update_item_product_stock_stock_status").is(":checked")||jQuery(".is_update_item_product_stock_low_stock_amount").is(":checked"))&&(e=!0),e===!1)return jQuery(".wpie_update_item_data_container").addClass("wpie_required"),!1}return jQuery(".wpie_update_item_data_container").removeClass("wpie_required"),!0}function wpieIsValidTime(){return!0}function wpieScrollTop(){jQuery("html, body").animate({scrollTop:0},300)}function wpieInitImport(e){var i={wpieSaveSettings:wpiePluginSettings.wpieLocalizeText.wpieSaveSettingsText};wpieSetProcessLoader(i);var t=wpiePluginSettings.importData.activeFile,p=1;jQuery(".wpie_import_type.wpie_active").hasClass("wpie_update_item")&&(p=0);var a=wpiePluginSettings.wpieImportId,r=wpiePluginSettings.importData[t].xpath,n=wpiePluginSettings.importData[t].root,o=0;"bg"===e&&(o="1");var s=jQuery(".wpie_import_frm").serialize();jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:"action=wpie_import_update_data&wpie_import_id="+a+"&wpieSecurity="+wpiePluginSettings.wpieSecurity+"&bg="+o+"&xpath="+r+"&root="+n+"&is_new_items="+p+"&"+s,dataType:"json",async:!0,success:function(i){if("error"===i.status)return wpieSetErrorMsg(i.message),!1;if(wpieUpdateProcessLoader("wpieSaveSettings"),"import"===e)wpieResetImportProcess(),wpiePluginSettings.importData.processStatus="processing",jQuery(".wpie_import_step:visible").hide(),jQuery(".wpie_import_step7").show(),wpieScrollTop(),wpieImportData();else if("bg"===e){var t=new bootstrap.Modal(jQuery(".wpie_import_bg_set"),{backdrop:"static",keyboard:!1});return t.show(),!1}},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieResetImportProcess(){var e=wpiePluginSettings.importData.activeFile;jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText),jQuery(".wpie_import_filename").html(wpiePluginSettings.importData[e].fileName),jQuery(".wpie_import_filesize").html(wpiePluginSettings.importData[e].fileSize),jQuery(".wpie_import_process_per").css("width","auto").text("0%"),jQuery(".wpie_import_created").text("0"),jQuery(".wpie_import_updated").text("0"),jQuery(".wpie_import_skipped").text("0"),jQuery(".wpie_import_processing_total").text("0"),jQuery(".wpie_import_time_elapsed").text("00:00:00"),jQuery(".wpie_import_total").text(wpiePluginSettings.importData[e].count),"undefined"!=typeof wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),wpiePluginSettings.importData.importIntervalSec=0,wpiePluginSettings.importData.importInterval=setInterval(function(){jQuery(".wpie_import_time_elapsed").html(wpieElapsedTimeString(wpiePluginSettings.importData.importIntervalSec++))},1e3)}function wpieElapsedTimeString(e){var i=Math.floor(e/3600);e%=3600;var t=Math.floor(e/60);e%=60;var p=Math.floor(e);return i=wpiePrettyTimeString(i),t=wpiePrettyTimeString(t),p=wpiePrettyTimeString(p),i+":"+t+":"+p}function wpiePrettyTimeString(e){return(10>e?"0":"")+e}function wpieObjectifyForm(e,i){var t={};return jQuery.each(e,function(e,i){t[i.name]=i.value}),jQuery.each(i,function(e,i){t[e]=i}),t}function wpieImportData(){if("processing"===wpiePluginSettings.importData.processStatus){wpiePluginSettings.importData.processing=!0;var e={action:"wpie_import_data",wpie_import_id:wpiePluginSettings.wpieImportId,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:e,dataType:"json",async:!0,success:function(e){if("error"===e.status)return wpieSetErrorMsg(e.message),!1;if("undefined"!=typeof e.imported&&null!==e.imported){jQuery(".wpie_import_created").text(parseInt(e.created)),jQuery(".wpie_import_updated").text(parseInt(e.updated)),jQuery(".wpie_import_skipped").text(parseInt(e.skipped)),jQuery(".wpie_import_processing_total").text(parseInt(e.imported));var i=wpiePluginSettings.importData.activeFile,t=parseInt(100*parseInt(e.imported)/parseInt(wpiePluginSettings.importData[i].count));t>100&&(t=100),jQuery(".wpie_import_process_per").css("width",t+"%").html(t+"%"),jQuery(".wpie_log_container").append(e.import_log),wpiePluginSettings.importData[i].count>parseInt(e.imported)?wpieImportData():wpieCompleteImport()}},error:function(e,i){wpiePluginSettings.importData.processing=!1,wpieHandleAjaxError(e,i)}})}else"pause"===wpiePluginSettings.importData.processStatus?("undefined"!=typeof wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),wpieUpdateProcessLoader("wpieProcessingNotice"),jQuery(".wpie_import_action_resume_btn").show(),jQuery(".wpie_import_action_pause_btn").hide(),wpiePluginSettings.importData.processing=!1):"stop"===wpiePluginSettings.importData.processStatus?("undefined"!=typeof wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),jQuery(".wpie_import_action_container").hide(),wpieUpdateProcessLoader("wpieProcessingNotice"),wpiePluginSettings.importData.processing=!1):"bg"===wpiePluginSettings.importData.processStatus&&("undefined"!=typeof wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),jQuery(".wpie_import_action_container").hide(),wpieUpdateProcessLoader("wpieProcessingNotice"),wpiePluginSettings.importData.processing=!1,wpieChangeStatus("bg"))}function wpieCompleteImport(){jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportCompleteText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportCompleteNoticeText),"undefined"!=typeof wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),jQuery(".wpie_import_action_container").hide(),jQuery(".wpie_import_processing_wrapper").hide(),jQuery(".wpie_import_process_complete_wrapper").show()}function wpieRefreshTemplateList(e){var i=jQuery(".wpie_template_list").chosen("destroy").html("");i.append(new Option(wpiePluginSettings.wpieLocalizeText.selectTemplateText,"")),jQuery.isEmptyObject(e)||jQuery.each(e,function(e,t){i.append(new Option(t.name,t.id))}),i.chosen()}function wpieImportGetTemplates(){var e=jQuery(".wpie_import_type_select").val();if("undefined"==typeof wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]=[]),"undefined"!=typeof wpiePluginSettings.importData[e].templates)wpieRefreshTemplateList(wpiePluginSettings.importData[e].templates),wpieUpdateProcessLoader("wpieGetTemplates");else{var i={action:"wpie_import_get_templates",wpie_import_type:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:i,dataType:"json",async:!0,success:function(i){return"error"===i.status?(wpieSetErrorMsg(i.message),!1):(wpieUpdateProcessLoader("wpieGetTemplates"),void("undefined"!=typeof i.templates&&(wpiePluginSettings.importData[e].templates=i.templates,wpieRefreshTemplateList(i.templates))))},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieRefreshSettingList(e){var i=jQuery(".wpie_setting_list").chosen("destroy").html("");i.append(new Option(wpiePluginSettings.wpieLocalizeText.selectTemplateText,"")),jQuery.isEmptyObject(e)||jQuery.each(e,function(e,t){i.append(new Option(t.name,t.id))}),i.chosen()}function wpieImportGetSettings(){var e=jQuery(".wpie_import_type_select").val();if("undefined"==typeof wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]=[]),"undefined"!=typeof wpiePluginSettings.importData[e].settings)wpieRefreshSettingList(wpiePluginSettings.importData[e].settings),wpieUpdateProcessLoader("wpieGetSettingsList");else{var i={action:"wpie_import_get_settings",type:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:i,dataType:"json",async:!0,success:function(i){return"error"===i.status?(wpieSetErrorMsg(i.message),!1):(wpieUpdateProcessLoader("wpieGetSettingsList"),void("undefined"!=typeof i.templates&&(wpiePluginSettings.importData[e].settings=i.templates,wpieRefreshSettingList(i.templates))))},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieSaveTemplate(e){var i=jQuery(".wpie_template_name").val();if(""===i&&0===e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.enterSettingNameText),!1;var t={wpieSaveTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieSaveSettingsText};wpieSetProcessLoader(t);var p=jQuery(".wpie_import_frm").serialize();jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:"action=wpie_import_save_templates&wpieSecurity="+wpiePluginSettings.wpieSecurity+"&template_id="+e+"&"+p,dataType:"json",async:!0,success:function(t){return"error"===t.status?(wpieSetErrorMsg(t.message),wpieUpdateProcessLoader("wpieSaveTemplatesText"),!1):(0===e?(jQuery(".wpie_template_list").append(new Option(i,t.template_id)).val("").trigger("chosen:updated"),jQuery(".wpie_template_name").val("")):"undefined"!=typeof wpiePluginSettings.importData.templateData&&"undefined"!=typeof wpiePluginSettings.importData.templateData[e]&&delete wpiePluginSettings.importData.templateData[e],wpieSetSuccessMsg(t.message),void wpieUpdateProcessLoader("wpieSaveTemplatesText"))},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieImportGetTemplateData(e){if("undefined"==typeof wpiePluginSettings.importData.templateData&&(wpiePluginSettings.importData.templateData=[]),"undefined"!=typeof wpiePluginSettings.importData.templateData[e])wpieUpdateProcessLoader("wpieGetTemplatesText"),wpieSetTemplate(wpiePluginSettings.importData.templateData[e]);else{var i={action:"wpie_import_get_template_data",wpie_template_id:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:i,dataType:"json",async:!0,success:function(i){return"error"===i.status?(wpieSetErrorMsg(i.message),!1):(wpieUpdateProcessLoader("wpieGetTemplatesText"),"undefined"!=typeof i.template_data&&(wpiePluginSettings.importData.templateData[e]=i.template_data,wpieSetTemplate(i.template_data)),void wpieUpdateProcessLoader("wpieChangeTemplates"))},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieExcludeCF(){jQuery(".wpie_exclude_cf_list").length&&jQuery(".wpie_exclude_cf_list").remove();var e="_thumbnail_id||_price||_variation_description",i=jQuery("<input>").attr("type","hidden").addClass("wpie_exclude_cf_list").appendTo(".wpie_content_data");i.val(e).trigger("add_exclude_cf_list");var t=i.val();if("undefined"==typeof t||""===t.trim())return[];t=t.trim();var p=t.replace(/^\|+|\|+$/g,"").split("||");return p}function wpieSetCFRec(e,i){if(!jQuery.isEmptyObject(e)){var t=0,p=wpieExcludeCF();jQuery.each(e,function(e,a){var r="";if("undefined"!=typeof a.name&&(r=a.name),""===r.trim())return!0;if(-1!==jQuery.inArray(r,p))return!0;t>0&&wpieAddNewCF(i);var n=i.children("tbody").children(".wpie_data_row").last();n.children(".wpie_item_cf_name_wrapper").find(".wpie_item_cf_name").val(r);var o="";"undefined"!=typeof a.value&&(o=a.value),n.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_normal_data").find(".wpie_item_cf_value").val(o);var s="";if("undefined"!=typeof a.option&&(s=a.option),n.children(".wpie_item_cf_option_wrapper").find(".wpie_item_cf_option").val(s).trigger("chosen:updated").trigger("change"),"serialized"===s&&"undefined"!=typeof a.values){var l=n.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_serialized_data_btn");wpieAddSerialyzeLayout(l,!1);var _=n.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_child_data").children(".wpie_cf_table");wpieSetCFRec(a.values,_)}t++})}}function wpieSetCF(e){if(jQuery(".wpie_cf_option_outer_wrapper .wpie_cf_option_wrapper:not(:first-child)").remove(),!jQuery.isEmptyObject(e))if("undefined"!=typeof e.wpie_item_cf&&null!==typeof e.wpie_item_cf){var i=jQuery(".wpie_cf_table");wpieSetCFRec(e.wpie_item_cf,i)}else if("undefined"!=typeof e.wpie_item_cf_name){var t=[];"undefined"!=typeof e.wpie_item_cf_value&&(t=e.wpie_item_cf_value);var p=[];"undefined"!=typeof e.wpie_item_cf_option&&(p=e.wpie_item_cf_option);var a=[];"undefined"!=typeof e.wpie_item_cf_serialize_key&&(a=e.wpie_item_cf_serialize_key);var r=[];"undefined"!=typeof e.wpie_item_cf_serialize_value&&(r=e.wpie_item_cf_serialize_value);var n={};if(jQuery.each(e.wpie_item_cf_name,function(e,i){var o=wpieRand(20);n[o]={},n[o].name=i;var s="";"undefined"!=typeof t[e]&&(s=t[e]),n[o].value=s;var l="normal";if("undefined"!=typeof p[e]&&"serialized"===p[e]&&(l=p[e]),n[o].option=l,"serialized"===l&&"undefined"!=typeof a[e]){var _=[];n[o].values={},"undefined"!=typeof r[e]&&(_=r[e]),jQuery.each(a[e],function(e,i){var t="";"undefined"!=typeof _[e]&&(t=_[e]);var p=wpieRand(20);n[o].values[p]={},n[o].values[p].name=i,n[o].values[p].value=t,n[o].values[p].option="normal"})}}),!jQuery.isEmptyObject(n)){var i=jQuery(".wpie_cf_table");wpieSetCFRec(n,i)}}}function wpieChangeStatus(e){wpieSetProcessLoader({wpieSetBGProcessText:wpiePluginSettings.wpieLocalizeText.wpieSetBGProcessText});var i=wpiePluginSettings.wpieImportId,t={action:"wpie_import_update_status",wpie_import_id:i,status:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:t,dataType:"json",async:!0,success:function(i){return"error"===i.status?(wpieSetErrorMsg(i.message),!1):(wpieUpdateProcessLoader("wpieSetBGProcessText"),void("bg"===e&&wpieSetSuccessMsg(wpiePluginSettings.wpieLocalizeText.wpieBgProcessingText)))},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieIsData(){return!0}function wpieSetTaxonomy(e){if(wpieResetTaxonomy(),!jQuery.isEmptyObject(e)&&"undefined"!=typeof e.wpie_item_set_taxonomy){var i=[];"undefined"!=typeof e.wpie_item_taxonomy&&(i=e.wpie_item_taxonomy);var t=[];"undefined"!=typeof e.wpie_item_taxonomy_delim&&(t=e.wpie_item_taxonomy_delim);var p=[];"undefined"!=typeof e.wpie_item_taxonomy_hierarchical_delim&&(p=e.wpie_item_taxonomy_hierarchical_delim);var a=[];"undefined"!=typeof e.wpie_item_taxonomy_child_only&&(a=e.wpie_item_taxonomy_child_only),jQuery.each(e.wpie_item_set_taxonomy,function(e,r){if(1!==r)return!0;if(jQuery(".wpie_item_set_taxonomy_"+e).prop("checked",!0),"undefined"!=typeof i[e]){var n=i[e];jQuery(".wpie_item_taxonomy_"+e).val(n)}"undefined"!=typeof t[e]&&jQuery(".wpie_item_taxonomy_delim_"+e).val(t[e]),"undefined"!=typeof p[e]&&jQuery(".wpie_item_taxonomy_hierarchical_delim_"+e).val(p[e]),"undefined"!=typeof a[e]&&1===a[e]?jQuery(".wpie_item_taxonomy_child_only_"+e).prop("checked",!0):jQuery(".wpie_item_taxonomy_child_only_"+e).prop("checked",!1)})}}function wpieResetTaxonomy(){jQuery(".wpie_item_set_taxonomy").prop("checked",!1),jQuery(".wpie_item_taxonomy").val(""),jQuery(".wpie_item_taxonomy_delim").val(","),jQuery(".wpie_item_taxonomy_hierarchical_delim").val(">"),jQuery(".wpie_taxonomy_hierarchical_child_only").prop("checked",!1)}window.wpiePluginSettings=window.wpiePluginSettings||{},jQuery(document).ready(function(e){if("undefined"==typeof wpiePluginSettings.wpieImportId&&(wpiePluginSettings.wpieImportId=0),"undefined"==typeof wpiePluginSettings.importData&&(wpiePluginSettings.importData=[]),wpiePluginSettings.isModalHide=!0,"function"==typeof jQuery.fn.chosen&&jQuery(".wpie_content_data_select").length&&jQuery(".wpie_content_data_select").chosen(),jQuery("#wpie_upload_container").length&&wpie_set_local_file_uploader(),jQuery(".wpie_import_ref_id").length){var i=jQuery(".wpie_import_ref_id").val();if(""===i){var t=jQuery(".wpie_error_msg").attr("msg");""!==t&&wpieSetErrorMsg(t)}else{var p=jQuery(".wpie_import_id").val(),a=jQuery(".wpie_import_nonce").val();wpieProcessingReimport(p,a,i)}}wpieSetToolTip(),"1"!==wpiePluginSettings.isUploadDirWritable&&wpieSetStrictErrorMsg(wpiePluginSettings.wpieLocalizeText.uploadDirWritableError)}),jQuery(document).on("wpieValidUploadFile",function(e){var i=jQuery(".wpie_import_ref_id").val();wpiePluginSettings.getImportTemplate=!1,""!==i&&(wpiePluginSettings.getImportTemplate=!0)}),jQuery(document).on("wpieAfterChangeConfig",function(e){if("undefined"!=typeof wpiePluginSettings.reImportData&&"undefined"!=typeof wpiePluginSettings.reImportData.status&&"completed"===wpiePluginSettings.reImportData.status)return!0;var i=jQuery(".wpie_import_ref_id").val();if(""!==i&&"undefined"!=typeof wpiePluginSettings.getImportTemplate&&wpiePluginSettings.getImportTemplate===!0){wpiePluginSettings.getImportTemplate=!1;var t={wpieChangeTemplates:wpiePluginSettings.wpieLocalizeText.wpieChangeTemplatesText,wpieGetTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieGetTemplatesText};wpieSetProcessLoader(t),wpieImportGetTemplateData(jQuery(".wpie_import_id").val()),jQuery(".wpie_import_step5_btn").trigger("click"),jQuery(".wpie_field_mapping_data_container").show()}}),jQuery(document).on("click",".wpie_upload_menu",function(){if(!jQuery(this).hasClass("wpie_active")){jQuery(".wpie_upload_menu.wpie_active").removeClass("wpie_active"),jQuery(this).addClass("wpie_active"),jQuery(".wpie_upload_section_wrapper:visible").hide();var e=jQuery(this).attr("show_container");jQuery(".wpie_file_upload_method").val(e),jQuery("."+e).show()}}),jQuery(document).on("show.bs.modal",".modal",function(e){var i=999999+10*jQuery(".modal:visible").length;jQuery(this).css("z-index",i),setTimeout(function(){jQuery(".modal-backdrop").not(".modal-stack").css("z-index",i-1).addClass("modal-stack")},0)}),jQuery(document).on("change",".wpie_taxonomies_types_select",function(){wpieRefreshImport()}),jQuery(document).on("change",".wpie_import_type_select",function(){wpieRefreshImport()}),jQuery(document).on("change",".wpie_sheet_list",function(){wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText});var e=wpiePluginSettings.importData.activeFile;wpiePluginSettings.importData[e].activeSheet=jQuery(this).val(),wpiePluginSettings.importData.changeExcelSheet=!0,wpieValidateUploadedFile(!0,",")}),jQuery(document).on("change",".wpie_text_format_list",function(){wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText});var e=wpiePluginSettings.importData.activeFile;wpiePluginSettings.importData[e].activeFormat=jQuery(this).val(),jQuery(".wpie_element_tag_wrapper").html(""),wpiePluginSettings.importData[e].node_list=[],wpieValidateUploadedFile(!0,",")}),jQuery(document).on("change",".wpie_upload_file_list",function(){wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText});var e=jQuery(this).val();wpiePluginSettings.importData.activeFile=e,"undefined"==typeof wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]={}),wpiePluginSettings.importData[e].activeSheet="",wpiePluginSettings.importData[e].activeFormat=jQuery(this).closest(".wpie_upload_section_wrapper").find(".wpie_text_format_list:checked").val(),jQuery(".wpie_text_format_list_wrapper").hide(),jQuery(".wpie_excel_sheets_wrapper").hide(),jQuery(".wpie_element_tag_wrapper").html(""),wpiePluginSettings.importData[e].node_list=[],wpieValidateUploadedFile(!0,",")}),jQuery(document).on("click",".wpie_layout_tag_wrapper",function(){if(!jQuery(this).hasClass("wpie_active")){var e={wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(e),jQuery(".wpie_element_nav_element").val(1),jQuery(".wpie_layout_tag_wrapper.wpie_active").removeClass("wpie_active"),jQuery(this).addClass("wpie_active");var i=jQuery(this).find(".wpie_layout_tag_name").html(),t="/"+i;jQuery(".wpie_xpath").val(t),wpieGetFilteredRecords(0,1,t,i,!0)}}),jQuery(document).on("click",".wpie_data_element_nav_next",function(){var e=parseInt(jQuery(".wpie_element_nav_element").val()),i=parseInt(jQuery(".wpie_data_element_action_nav_total").html());if(i>e){e++;var t={wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(t);var e=parseInt(jQuery(".wpie_element_nav_element").val())+1;wpieGotoRecord(e)}}),jQuery(document).on("click",".wpie_data_element_nav_prev",function(){if(1===parseInt(jQuery(".wpie_element_nav_element").val()))return!1;var e={wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(e);var i=parseInt(jQuery(".wpie_element_nav_element").val())-1;wpieGotoRecord(i)}),jQuery(document).on("blur",".wpie_element_nav_element",function(){var e={wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(e);var i=wpiePluginSettings.importData.activeFile,t=wpiePluginSettings.importData[i].count,p=parseInt(jQuery(this).val());(p>t||1>p)&&(p=1),wpieGotoRecord(p)}),jQuery(document).on("click",".wpie_tag.wpie_opening",function(){return jQuery(this).find(".wpie_layout_tag_icon").length&&(jQuery(this).hasClass("wpie_collapsed")?jQuery(this).removeClass("wpie_collapsed"):jQuery(this).addClass("wpie_collapsed")),!1}),jQuery(document).on("click",".wpie_save_add_rule_btn",function(){wpieShowLoader();var e=wpieAddNewImportRule();e&&(jQuery(".wpie_element_list").val("").trigger("chosen:updated"),jQuery(".wpie_element_rule").val("").trigger("chosen:updated"),jQuery(".wpie_element_value").val("")),wpieHideLoader()}),jQuery(document).on("change",".wpie_import_file_processing",function(){"chunk"===jQuery(this).val()?jQuery(".wpie_iteration_process_wrapper").slideDown():jQuery(".wpie_iteration_process_wrapper").slideUp()}),jQuery(document).on("change",".wpie_item_cf_option",function(){"serialized"===jQuery(this).val()?(jQuery(this).closest("tr").find(".wpie_cf_serialized_data_btn").show(),jQuery(this).closest("tr").find(".wpie_cf_normal_data").hide()):(jQuery(this).closest("tr").find(".wpie_cf_serialized_data_btn").hide(),jQuery(this).closest("tr").find(".wpie_cf_normal_data").show())}),jQuery(document).on("click",".wpie_cf_serialized_data_btn",function(){wpieAddSerialyzeLayout(jQuery(this),!0)}),jQuery(document).on("click",".wpie_cf_serialized_close_btn",function(){jQuery(".wpie_cf_serialized_data").hide()}),jQuery(document).on("click",".wpie_cf_add_btn",function(){var e=jQuery(this).closest("table");wpieAddNewCF(e)}),jQuery(document).on("click",".wpie_cf_close_btn",function(){jQuery(this).closest(".wpie_cf_child_data").hide()}),jQuery(document).on("click",".wpie_cf_serialized_add_btn",function(){var e=jQuery(this).closest(".wpie_cf_serialized_wrapper");wpieAddNewSerializeCF(e)}),jQuery(document).on("click",".wpie_remove_cf_btn",function(){if(jQuery(this).closest("tbody").children("tr").length<=1){var e=jQuery(this).closest("table");jQuery(this).closest("tr").find(".wpie_cf_child_data").hide(),wpieAddNewCF(e)}jQuery(this).closest("tr").remove()}),jQuery(document).on("click",".wpie_trash_cf_serialized_btn_wrapper",function(){var e=jQuery(this).closest(".wpie_cf_serialized_wrapper");e.find(".wpie_cf_serialized_option_wrapper").length<=1&&wpieAddNewSerializeCF(e),jQuery(this).closest(".wpie_cf_serialized_option_wrapper").remove()}),jQuery(document).on("click",".wpie_rule_trash_btn",function(){jQuery(this).closest("tr").remove(),jQuery(".wpie_filter_data_rule").length>=1?jQuery(".wpie_filter_data_rule").last().find(".wpie_filter_data_rule_cond_data").html(""):jQuery(".wpie_apply_rule_wrapper").hide()}),jQuery(document).on("click",".wpie_apply_rule_btn",function(){var e=wpiePluginSettings.importData.activeFile,i=jQuery(".wpie_xpath").val(),t="[";t+=wpieXpathBuilder(jQuery(".wpie_filter_data_rule"),0),t+="]",i=i.split("[")[0]+t,wpieUpdateXpath(i,wpiePluginSettings.importData[e].root)}),jQuery(document).on("blur",".wpie_xpath",function(){var e=jQuery(this).val(),i=wpiePluginSettings.importData.activeFile;if(wpiePluginSettings.importData[i].xpath!==e){var t={wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(t),wpiePluginSettings.importData[i].xpath=e,wpieGetFilteredRecords(0,1,wpiePluginSettings.importData[i].xpath,wpiePluginSettings.importData[i].root,!0)}}),jQuery.fn.wpieInsertAtCaret=function(){if(!this.length)return this;var e,i=this,t=0,p=jQuery(".wpie_drag_element");p.length||(p=jQuery('<input type="text" class="wpie_drag_element" readonly="readonly" />')),p.appendTo(document.body).mousedown(function(e){if(!t){var i=e.pageX-p.offset().left,a=e.pageY-p.offset().top;4>i||4>a||p.width()-i<0||p.height()-a<0||(p.css("opacity",1),p.select(),t=!0,setTimeout(function(){t=!1},400))}}).mouseup(function(){p.css("opacity",0).css("width",e),p.blur()}),jQuery(document).mousemove(function(){0!==parseInt(p.css("opacity"))&&(setTimeout(function(){p.css("opacity",0)},50),setTimeout(function(){p.css("width",e)},500))}),i.each(function(){var i=jQuery(this),t="{"+i.attr("data_value")+"}";i.mouseover(function(a){p.val(t).offset({left:i.offset().left-2,top:i.offset().top-2}).width(e=i.width()+8).height(i.height())})}).eq(0).mouseover()},jQuery(document).on("click",".wpie_import_step_btn",function(){return jQuery(this).hasClass("wpie_import_step3_btn")&&wpieIsValidTime()===!1||jQuery(this).hasClass("wpie_import_step6_btn")?!1:(jQuery(".wpie_import_step").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),void wpieScrollTop())}),jQuery(document).on("click",".wpie_import_step3_back",function(){jQuery(".wpie_field_mapping_data_container").hide()}),jQuery(document).on("click",".wpie_import_step3_btn,.wpie_import_step5_back",function(){jQuery(".wpie_field_mapping_data_container").show()}),jQuery(document).on("click",".wpie_import_step6_btn",function(){if(!wpieValidateUpdateFields())return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.chooseDataUpdate),!1;wpieShowLoader();var e=wpiePluginSettings.importData.activeFile;jQuery(".wpie_import_total_count").html(wpiePluginSettings.importData[e].count),jQuery(".wpie_import_filename").html(wpiePluginSettings.importData[e].fileName),jQuery(".wpie_import_filesize").html(wpiePluginSettings.importData[e].fileSize),jQuery(".wpie_import_per_iteration").html(jQuery(".wpie_records_per_request").val()),
jQuery(".wpie_import_update_criteria").html(jQuery(".wpie_existing_item_search_logic:checked").val());var i=jQuery(".wpie_handle_items:checked").val();jQuery(".wpie_import_item_selection_text").hide(),"existing"===i?(jQuery(".wpie_existing_item_update").show(),jQuery(".wpie_new_item_skip").show()):"new"===i?(jQuery(".wpie_existing_item_skip").show(),jQuery(".wpie_new_item_create").show()):(jQuery(".wpie_existing_item_update").show(),jQuery(".wpie_new_item_create").show()),jQuery(".wpie_update_item_data_container").removeClass("wpie_required"),jQuery(".wpie_import_step").hide(),jQuery(".wpie_field_mapping_data_container").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),wpieHideLoader(),wpieScrollTop()}),jQuery(document).on("change",".wpie_item_update_specific",function(){wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_item_update_all",function(){wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_item_update_field",function(){wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_item_update_price_stock_item,.wpie_item_update_product_price_stock",function(){wpieValidateUpdateFields()}),jQuery(document).on("click",".wpie_import_step3_btn",function(){if(!wpieValidateProcess())return!1;var e=wpiePluginSettings.importData.activeFile;return 0===wpiePluginSettings.importData[e].count?(wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieNoRecordsFoundText),!1):(jQuery(".wpie_import_step").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),void wpieScrollTop())}),jQuery(document).on("click",".wpie_import_step1_btn",function(){var e=!1,i=wpiePluginSettings.wpieLocalizeText.wpieChooseValidFileText,t=jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").val();return jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").length?(wpiePluginSettings.importData.activeFile=t,"undefined"==typeof wpiePluginSettings.importData[t]?e=!0:"undefined"==typeof wpiePluginSettings.importData[t].fileName?e=!0:0===wpiePluginSettings.importData[t].count&&(e=!0,i=wpiePluginSettings.wpieLocalizeText.wpieNoRecordsText)):e=!0,e?(wpieSetErrorMsg(i),!1):(jQuery(".wpie_import_step").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),void wpieScrollTop())}),jQuery(document).on("scroll",function(){if(jQuery(".wpie_field_mapping_data_wrapper").is(":visible")){var e=jQuery(".wpie_field_mapping_data_container").offset();if(jQuery(document).scrollTop()>parseInt(e.top-65)){var i=jQuery(".wpie_field_mapping_data_container").css("width");jQuery(".wpie_field_mapping_data_wrapper").css({width:i,top:"60px",position:"fixed"}),jQuery(".wpie_field_mapping_data_wrapper").find(".wpie_data_fields_container").css({"max-height":jQuery(window).height()-160+"px"})}else{var i=jQuery(".wpie_field_mapping_data_container").css("width");jQuery(".wpie_field_mapping_data_wrapper").css({width:"",top:"",position:""}),jQuery(".wpie_field_mapping_data_wrapper").find(".wpie_data_fields_container").css({"max-height":""})}}}),jQuery(document).on("click",".wpie_import_btn",function(){return wpieIsData()===!1?(wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieInvalidLicense),!1):void wpieInitImport("import")}),jQuery(document).on("click",".wpie_import_action_pause_btn",function(){if(jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportPausedText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportPartiallyText),wpiePluginSettings.importData.processStatus="pause",wpiePluginSettings.importData.processing===!0){var e={wpieProcessingNotice:wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText};wpieSetProcessLoader(e)}else jQuery(".wpie_import_action_resume_btn").show(),jQuery(".wpie_import_action_pause_btn").hide()}),jQuery(document).on("click",".wpie_import_action_stop_btn",function(){if(wpiePluginSettings.importData.processStatus="stop",jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportStoppedText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportPartiallyText),wpiePluginSettings.importData.processing===!0){var e={wpieProcessingNotice:wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText};wpieSetProcessLoader(e)}else jQuery(".wpie_import_action_container").hide()}),jQuery(document).on("click",".wpie_import_action_resume_btn",function(){wpiePluginSettings.importData.processStatus="processing",jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText),wpiePluginSettings.importData.importInterval=setInterval(function(){jQuery(".wpie_import_time_elapsed").html(wpieElapsedTimeString(wpiePluginSettings.importData.importIntervalSec++))},1e3),jQuery(this).hide(),jQuery(".wpie_import_action_pause_btn").show(),wpieImportData()}),jQuery(document).on("click",".wpie_field_mapping_container_title",function(){jQuery(this).hasClass("wpie_active")?jQuery(this).removeClass("wpie_active"):jQuery(this).addClass("wpie_active"),jQuery(this).parent().find(".wpie_field_mapping_container_data").slideToggle()}),jQuery(document).on("click",".wpie_save_template_btn",function(){wpieSaveTemplate(0)}),jQuery(document).on("click",".wpie_update_template_btn",function(){var e=jQuery(".wpie_template_list").val();return""===e?(wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.selectSettingText),!1):void wpieSaveTemplate(e)}),jQuery(document).on("click",".wpie_update_item_all_action",function(){jQuery(".wpie_item_update_field").length===jQuery(".wpie_item_update_field:checked").length?jQuery(".wpie_item_update_field").prop("checked",!1):jQuery(".wpie_item_update_field").prop("checked",!0),wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_template_list",function(){if(""!==jQuery(this).val()){var e={wpieChangeTemplates:wpiePluginSettings.wpieLocalizeText.wpieUpdateSettingsText,wpieGetTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieGetSettingsText};jQuery(".wpie_update_template_btn_wrapper").show(),jQuery(".wpie_setting_list").val("").trigger("chosen:updated"),wpieSetProcessLoader(e),wpieImportGetTemplateData(jQuery(this).val())}else jQuery(".wpie_update_template_btn_wrapper").hide()}),jQuery(document).on("change",".wpie_setting_list",function(){if(""!==jQuery(this).val()){var e={wpieChangeTemplates:wpiePluginSettings.wpieLocalizeText.wpieUpdateSettingsText,wpieGetTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieGetSettingsText};jQuery(".wpie_update_template_btn_wrapper").hide(),jQuery(".wpie_template_list").val("").trigger("chosen:updated"),wpieSetProcessLoader(e),wpieImportGetTemplateData(jQuery(this).val())}}),jQuery(document).on("click",".wpie_file_option_btn",function(){var e=jQuery(".wpie_csv_delimiter").val();if(""===e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.enterCsvDelimiterText),!1;var i={wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText};wpieSetProcessLoader(i),wpieValidateUploadedFile(!0,e)}),jQuery(document).on("change",".wpie_item_image_option",function(){var e=jQuery(this).val();"media_library"===e?jQuery(".wpie_image_media_option_data").slideUp():jQuery(".wpie_image_media_option_data").slideDown()}),jQuery(document).on("click",".wpie_import_step5_btn",function(){jQuery(".wpie_update_item_data_container").removeClass("wpie_required")}),jQuery(document).on("click",".wpie_existing_file_btn",function(){var e=jQuery(".wpie_upload_existing_file").val();if(""===e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieChooseValidFileText),!1;wpieSetProcessLoader({wpieSetExistingFileText:wpiePluginSettings.wpieLocalizeText.wpieSetExistingFileText});var i={action:"wpie_import_set_existing_file",wpie_import_id:wpiePluginSettings.wpieImportId,file_name:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:i,dataType:"json",async:!0,success:function(i){return wpieUpdateProcessLoader("wpieSetExistingFileText"),"error"===i.status?(wpieSetErrorMsg(i.message),!1):(jQuery(".wpie_final_existing_file").val(e),void wpieSetFileData(i))},error:function(e,i){wpieHandleAjaxError(e,i)}})}),jQuery(document).on("click",".wpie_pre_import_btn .wpie_import_bg_process_btn",function(){wpieInitImport("bg")}),jQuery(document).on("click",".wpie_import_processing_btn .wpie_import_bg_process_btn",function(){if(wpiePluginSettings.importData.processStatus="bg",jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportBGText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportBGNoticeText),wpiePluginSettings.importData.processing===!0){var e={wpieProcessingNotice:wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText};wpieSetProcessLoader(e)}else jQuery(".wpie_import_action_container").hide(),wpieChangeStatus("bg")}),jQuery(document).on("click",".wpie_save_scheduled_btn",function(){wpieSetProcessLoader({wpieSetScheduleExport:wpiePluginSettings.wpieLocalizeText.wpieSetScheduleExportText});var e=wpiePluginSettings.importData.activeFile,i=1;jQuery(".wpie_import_type.wpie_active").hasClass("wpie_update_item")&&(i=0);var t=wpiePluginSettings.wpieImportId,p=wpiePluginSettings.importData[e].xpath,a=wpiePluginSettings.importData[e].root,r=0,n=jQuery(".wpie_import_frm").serialize();jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:"action=wpie_save_import_scheduled&wpie_import_id="+t+"&wpieSecurity="+wpiePluginSettings.wpieSecurity+"&bg="+r+"&xpath="+p+"&root="+a+"&is_new_items="+i+"&"+n,dataType:"json",async:!0,success:function(e){if("error"===e.status)return wpieSetErrorMsg(e.message),!1;wpieUpdateProcessLoader("wpieSetScheduleExport");var i=new bootstrap.Modal(jQuery(".wpie_save_schedule_status_notify"),{backdrop:"static",keyboard:!1});return i.show(),!1},error:function(e,i){wpieHandleAjaxError(e,i)}})}),jQuery(document).on("click",".wpie_url_upload_btn",function(){var e=jQuery(".wpie_file_upload_url").val();if(""===e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieInvalidURLText),!1;wpieSetProcessLoader({wpieUploadFromURLText:wpiePluginSettings.wpieLocalizeText.wpieUploadFromURLText});var i={action:"wpie_import_upload_file_from_url",wpie_import_id:wpiePluginSettings.wpieImportId,file_url:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:i,dataType:"json",async:!0,success:function(i){return wpieUpdateProcessLoader("wpieUploadFromURLText"),"error"===i.status?(wpieSetErrorMsg(i.message),!1):(jQuery(".wpie_upload_final_file_url").val(e),void wpieSetFileData(i))},error:function(e,i){wpieUpdateProcessLoader("wpieUploadFromURLText"),wpieHandleAjaxError(e,i)}})}),jQuery(document).on("change",".wpie_item_dropdown_as_specified",function(){var e=jQuery(this).val();"as_specified"===e?jQuery(".wpie_item_as_specified_wrapper").show():jQuery(".wpie_item_as_specified_wrapper").hide()}),jQuery(document).on("click",".wpie_ftp_upload_btn",function(){var e=jQuery(".wpie_ftp_hostname").val(),i=jQuery(".wpie_ftp_host_port").val(),t=jQuery(".wpie_ftp_host_username").val(),p=jQuery(".wpie_ftp_host_password").val(),a=jQuery(".wpie_ftp_host_path").val(),r=jQuery(".wpie_connection_type:checked").val(),n="";if(""===e?n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostNameText:""===t?n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostUsernameText:""===p?n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostPasswordText:""===a&&(n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostPathText),""!==n)return wpieSetErrorMsg(n),!1;var o={host:e,port:i,username:t,password:p,path:a,connection_type:r};jQuery(".wpie_ftp_details").val(JSON.stringify(o)),wpieSetProcessLoader({wpieUploadFromFTPText:wpiePluginSettings.wpieLocalizeText.wpieUploadFromFTPText});var s={action:"wpie_import_upload_file_from_ftp",wpie_import_id:wpiePluginSettings.wpieImportId,host:e,port:i,username:t,password:p,path:a,connection_type:r,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:s,dataType:"json",async:!0,success:function(e){return wpieUpdateProcessLoader("wpieUploadFromFTPText"),"error"===e.status?(wpieSetErrorMsg(e.message),!1):void wpieSetFileData(e)},error:function(e,i){wpieHandleAjaxError(e,i)}})}),jQuery(document).on("change",".wpie_item_attribute_source",function(){var e=jQuery(this).val();"as_specified"===e?jQuery(".wpie_attribute_search_existing_data").show():jQuery(".wpie_attribute_search_existing_data").hide()}),jQuery(document).on("click",".wpie_show_more_data",function(){var e=jQuery(this).parent().find(".wpie_tag_content_text"),i=jQuery(this).parent().find(".wpie_tag_content_full_text");jQuery(this).hasClass("wpie_show_less")?(e.css("display","inline"),i.hide(),jQuery(this).removeClass("wpie_show_less").text(wpiePluginSettings.wpieLocalizeText.showMoreText)):(e.hide(),i.css("display","inline"),jQuery(this).addClass("wpie_show_less").text(wpiePluginSettings.wpieLocalizeText.showLessText))}),jQuery(document).on("click",".wpie_inner_section_label",function(){var e=jQuery(this).find(".wpie_inner_section_icon");e.hasClass("fa-chevron-down")?(e.removeClass("fa-chevron-down"),e.addClass("fa-chevron-up")):(e.addClass("fa-chevron-down"),e.removeClass("fa-chevron-up")),jQuery(this).parent().find(".wpie_inner_section_container").slideToggle()});